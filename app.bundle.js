!function(){"use strict";class e{constructor(){this.cardTodo=document.querySelector(".todo"),this.cardInProgress=document.querySelector(".in_progress"),this.cardDone=document.querySelector(".done")}static renderingTextTask(e,t){const o=document.createElement("div"),n=document.createElement("p");o.classList.add("task"),n.classList.add("task_text"),n.textContent=t,e.querySelector(".btn").parentNode.insertBefore(o,e.querySelector(".btn")),o.prepend(n)}actionStorage(t){t.toDo.forEach((t=>{e.renderingTextTask(this.cardTodo,t)})),t.inProgress.forEach((t=>{e.renderingTextTask(this.cardInProgress,t)})),t.done.forEach((t=>{e.renderingTextTask(this.cardDone,t)}))}}const t=new class{constructor(){this.storage=localStorage}save(e){this.storage.setItem("dataTask",JSON.stringify(e))}load(){try{return JSON.parse(this.storage.getItem("dataTask"))}catch(e){throw new Error("Invalid data")}}remove(){let e=this.load();e={},this.save(e)}},o=new e,n=t.load(),s={};null===n||void 0===n.toDo?t.load():o.actionStorage(n);const r=document.querySelector(".save_button");document.querySelector(".reset_button").addEventListener("click",(()=>{Array.from(document.querySelectorAll(".task")).forEach((e=>{e.remove()})),t.remove()})),r.addEventListener("click",(()=>{const e=Array.from(document.querySelector(".todo").querySelectorAll(".task_text")),o=Array.from(document.querySelector(".in_progress").querySelectorAll(".task_text")),n=Array.from(document.querySelector(".done").querySelectorAll(".task_text"));s.toDo=[],s.inProgress=[],s.done=[],e.forEach((e=>{s.toDo.push(e.textContent)})),o.forEach((e=>{s.inProgress.push(e.textContent)})),n.forEach((e=>{s.done.push(e.textContent)})),t.save(s)}));const c=document.querySelector(".container");let a;c.querySelectorAll(".btn").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),function(e){const t=document.createElement("div");t.classList.add("add_card_container");const o=document.createElement("textarea");o.classList.add("textarea"),o.placeholder="Введите задание...";const n=document.createElement("button");n.classList.add("button_add"),n.textContent="Добавить";const s=document.createElement("button");s.classList.add("button_close"),t.append(o,n,s),e.closest(".card_item").append(t);const r=()=>{t.closest(".card_item").appendChild(e),t.remove(t)};s.addEventListener("click",r),n.addEventListener("click",(()=>{const e=document.createElement("div");e.classList.add("task"),t.closest(".card_item").appendChild(e);const n=document.createElement("p");n.classList.add("task_text"),n.textContent=o.value;const s=document.createElement("button");s.classList.add("button_close"),e.append(n,s),r()}))}(e),e.remove(e)}))}));const l=e=>{const t=e.target.closest(".task");if(t){const o=e.target.closest(".button_close");o&&o.addEventListener("click",(()=>{t.remove()}))}};document.addEventListener("mousemove",l);const d=e=>{const{target:t}=e;if(a.style.top=e.clientY-20+"px",a.style.left=e.clientX-50+"px",t.classList.contains("task")||t.classList.contains("card_tittle")){const{y:o,height:n}=t.getBoundingClientRect(),s=function(e){const t=document.createElement("div"),{width:o,height:n}=e.getBoundingClientRect();return t.classList.add("shadow_element"),t.style.width=`${o}px`,t.style.height=`${n}px`,t}(document.querySelector(".dragged"));let r;o+n/2>e.clientY&&!t.classList.contains("card_tittle")&&(document.querySelector(".shadow_element")&&document.querySelector(".shadow_element").remove(),r=e.target.previousElementSibling.closest(".task")||e.target.previousElementSibling.closest(".card_tittle"),r&&r.insertAdjacentElement("afterend",s)),o+n/2<e.clientY&&(document.querySelector(".shadow_element")&&document.querySelector(".shadow_element").remove(),r=e.target.nextElementSibling.closest(".task")||e.target.nextElementSibling.closest(".btn"),r&&r.insertAdjacentElement("beforebegin",s))}},i=e=>{const t=e.target.closest(".card_item");if(a.style.top=null,a.style.left=null,e.target.classList.contains("shadow_element")){const e=t.querySelector(".shadow_element");t.insertBefore(a,e)}a.style.width=null,a.style.height=null,a.classList.remove("dragged"),a=void 0,document.querySelector(".shadow_element")&&document.querySelector(".shadow_element").remove(),document.documentElement.removeEventListener("mousemove",d),document.documentElement.removeEventListener("mouseup",i)};c.querySelectorAll(".card_item").forEach((e=>{e.addEventListener("mousedown",(e=>{if(e.target.closest(".task")&&!e.target.closest(".button_close")){e.preventDefault(),a=e.target.closest(".task");const{width:t,height:o}=a.getBoundingClientRect();a.classList.add("dragged"),document.removeEventListener("mousemove",l),a.style.top=null,a.style.left=null,a.style.width=`${t}px`,a.style.height=`${o}px`,document.documentElement.addEventListener("mousemove",d),document.documentElement.addEventListener("mouseup",i)}}))}))}();